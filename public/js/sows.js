// Generated by CoffeeScript 1.3.3
(function() {

  $(document).on("ready pjax:success", function() {
    $('.datepicker').datepicker({
      autoclose: true
    });
    $(".form-sections input.section-toggle:checked").each(function() {
      return $(this).closest(".control-group").addClass("checked").find("input[disabled]").removeAttr('disabled');
    });
    $(".sow-content p input[type=text]").autoGrow({
      comfortZone: 5
    });
    $(".checkbox-tooltip").tooltip({
      placement: 'top'
    });
    if ($("#sow-content-wysiwyg").length > 0) {
      return $("#sow-content-wysiwyg").wysihtml5({
        parserRules: wysihtml5ParserRules,
        stylesheets: ["/css/bootstrap.css", "/css/wysihtml5.css"]
      });
    }
  });

  $(document).on("click", ".examples-toggle", function() {
    if ($(".examples").is(":visible")) {
      $(this).text($(this).data('show-text'));
    } else {
      $(this).text($(this).data('hide-text'));
    }
    return $(".examples").slideToggle(250);
  });

  $(document).on("focus", ".sow-content p input[type=text]", function() {
    var el;
    el = $(this);
    el.tooltip({
      title: el.data('helper-text'),
      placement: 'bottom',
      trigger: 'manual'
    });
    return el.tooltip('show');
  });

  $(document).on("keydown", ".sow-content p input[type=text]", function(e) {
    var index, input, inputs;
    if (e.keyCode === 13 || e.keyCode === 9) {
      inputs = $("input[data-variable]");
      index = inputs.index(this) + 1;
      while (index < inputs.length) {
        input = $(inputs[index]);
        if (input.val() === "") {
          e.preventDefault();
          return input.select();
        }
        index++;
      }
    }
  });

  $(document).on("blur", ".sow-content p input[type=text]", function() {
    return $(this).tooltip('hide');
  });

  $(document).on("input blur", ".sow-content p input[type=text]", function(e) {
    var el, variableName, variableValue;
    el = $(this);
    variableName = el.data('variable');
    variableValue = el.val();
    return $(".sow-content p input[data-variable=" + variableName + "]").each(function() {
      $(this).val(variableValue);
      return $(this).trigger("input.autogrow");
    });
  });

  $(document).on("click", ".form-sections input.section-toggle", function() {
    if (this.checked) {
      return $(this).closest(".control-group").addClass("checked").find("input[disabled]").removeAttr('disabled');
    } else {
      return $(this).closest(".control-group").removeClass("checked").find("input[name*=deliverable_dates]").attr('disabled', '');
    }
  });

  $(document).on("click", "#add-custom-choice-btn", function(e) {
    var newChoice, text;
    e.preventDefault();
    text = $("#add-custom-choice-text").val();
    if (!text) {
      return;
    }
    $("#add-custom-choice-text").val('');
    newChoice = $(".custom-choices .template").clone();
    newChoice.find("input[disabled]").removeAttr('disabled');
    newChoice.appendTo(".custom-choices");
    newChoice.find(".choice-name span").html(text);
    newChoice.find(".choice-name input[name=custom_sections\\[\\]]").val(text);
    newChoice.removeClass("template");
    return newChoice.find(".datepicker").datepicker({
      autoclose: true
    });
  });

  $(document).on("click", ".custom-choices li a", function() {
    return $(this).closest("li").remove();
  });

}).call(this);
